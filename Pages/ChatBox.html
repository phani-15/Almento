<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chatbox</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Hide scrollbar but allow scrolling */
        .scrollbar-hide::-webkit-scrollbar {
            display: none;
        }

        .scrollbar-hide {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
    </style>
</head>

<body class="bg-[#594E5C]">
    <div class="h-[100vh] flex fixed w-full">
        <!-- Sidebar -->
        <div class="w-[25vw] bg-[#0F0113] flex flex-col">
            <!-- Header -->
            <div class="flex h-16 m-5 items-center">
                <img src="../images/Logo.png" class="size-[80px]" alt="logo">
                <h2 class="text-white text-[30px] mx-8">Chats</h2>
            </div>

            <!-- Search Bar -->
            <div class="bg-[#310e3b] mx-5 h-10 rounded-full flex items-center px-4">
                <input type="text" id="chatName"
                    class="bg-[#310e3b] text-white w-full outline-none placeholder-gray-300"
                    placeholder="Search a Chat">
                <button onclick="findChat()">
                    <img src="../images/search.png" class="size-[20px]" alt="search">
                </button>
            </div>
            <div class="h-8 text-[#FF4C4C] text-center " id="Alert"></div>

            <!-- Chat List with Hidden Scrollbar -->
            <div class="relative h-[calc(100vh-8rem)] overflow-y-auto px-3 mt-4 scrollbar-hide">
                <ul id="chatList" class="text-white space-y-2"></ul>
            </div>
        </div>

        <!-- Chat Space -->
        <div class="bg-[#3E1F47] flex flex-col w-[75vw]">
            <div class="h-16 w-full" id="ChatHead"></div>
            <div class="flex-1 overflow-y-auto p-4 scrollbar-hide  bg-[url('../images/Logo.png')] bg-center bg-no-repeat opacity-30"
                id="chats"></div>

            <!-- Message Input Field -->
            <div class="h-16 bg-[#310e3b] flex items-center px-4 hidden" id="typeSpace">
                <input type="text" id="messageInput"
                    class="w-full bg-[#310e3b] text-white outline-none placeholder-gray-300 px-3 py-2 rounded-lg"
                    placeholder="Type a message...">
                <button onclick="sendMessage()" class="ml-4 text-white px-4 py-2 rounded-lg">
                    <img src="../images/send-horizontal.png" class="w-10" alt="">
                </button>
            </div>
        </div>
    </div>

    <script>
        function sendMessage() {
            let inputField = document.getElementById("messageInput");
            let message = inputField.value.trim();
            if (message) {
                let chatBox = document.getElementById("chats");
                let newMessage = document.createElement("div");
                newMessage.className = "text-white bg-[#A9A9A9] p-2 px-4 rounded-full w-fit max-w-[60%] self-end my-2";
                newMessage.innerText = message;
                chatBox.appendChild(newMessage);
                inputField.value = "";
                chatBox.scrollTop = chatBox.scrollHeight; // Auto-scroll to the latest message
            }
        }

        function openChat(index) {
            let chatPage = document.getElementById('ChatHead');
            chatPage.classList.add("bg-[#21012A]", "flex")
            chatPage.innerHTML = ""

            let image = document.createElement('img');
            image.src = "../images/UserIcon.png"
            image.classList.add('size-[45px]', 'mx-5', "mt-2");

            let div = document.createElement("div");
            div.textContent = names[index]
            div.classList.add('text-2xl', 'ml-5', "text-white", "mt-4")

            chatPage.appendChild(image)
            chatPage.appendChild(div)

            document.getElementById("typeSpace").classList.remove("hidden")
        }

        // Chat Names Array
        let names = ["vinay", "Padhu", "Phani", "Noor", "pragna", "swaroop", "nagendra", "srujana", "pavan", "mounika", "sirisha", "nageswari", "jasmika", "satya", "srilaxmi"];
        let chatList = document.getElementById('chatList');

        // Load Initial Chats
        names.forEach((name, index) => {
            let li = document.createElement('li');
            li.classList.add('flex', 'bg-[#310e3b]', 'h-16', 'rounded-full', 'items-center', 'px-5', 'hover:cursor-pointer');

            let img = document.createElement('img');
            img.src = "../images/UserIcon.png";
            img.classList.add('size-[45px]');

            let div = document.createElement('div');
            div.textContent = name;
            div.classList.add('text-xl', 'ml-5');

            li.appendChild(img);
            li.appendChild(div);
            chatList.appendChild(li);
            li.addEventListener("click", () => openChat(index))

        })

        // function to check names are same or not
        function isEqualIgnoreCase(str1, str2) {
            let st1 = str1.toLowerCase()
            let st2 = str2.toLowerCase()
            return (st1 === st2)
        }

        document.getElementById("messageInput").addEventListener("keypress", function (event) {
            if (event.key === "Enter") {
                sendMessage();
            }
        })

        document.getElementById("chatName").addEventListener("keypress", function (event) {
            if (event.key === "Enter") { // Check if Enter is pressed
                findChat();
            }
        });
        // Function to Find Chat
        function findChat() {
            let Name = document.getElementById('chatName').value.trim();
            let alert = document.getElementById('Alert')
            let found = false
            if (Name !== "") {
                for (let name of names) {
                    if (isEqualIgnoreCase(name, Name)) {
                        alert.textContent = ""
                        openChat(names.indexOf(name))
                        document.getElementById("chatName").value = ""
                        found = true
                        break;
                    }
                }
            }
            if (!found) {
                alert.textContent = "chat is not found"
            }
        }
    </script>
</body>

</html>